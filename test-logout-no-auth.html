<!doctype html>
<html>
  <head>
    <title>Logout Test (No Auth Required)</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      button {
        padding: 10px 20px;
        margin: 10px;
        font-size: 16px;
      }
      .result {
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #ccc;
      }
    </style>
  </head>
  <body>
    <h1>Logout Test (No Auth Required)</h1>
    <p>
      This page tests the logout functionality without requiring authentication.
    </p>

    <button onclick="testLogout()">Test Logout API</button>
    <button onclick="testSessionStatus()">Check Session Status</button>
    <button onclick="clearAllCookies()">Clear All Cookies</button>

    <div id="result" class="result">Ready to test...</div>

    <script>
      function log(message) {
        const result = document.getElementById('result');
        result.innerHTML +=
          '<br>' + new Date().toLocaleTimeString() + ': ' + message;
        console.log(message);
      }

      async function testLogout() {
        log('ğŸ”´ Testing logout API...');
        try {
          const response = await fetch('/api/auth/logout', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            credentials: 'include',
          });

          log('ğŸ”´ Response status: ' + response.status);
          log('ğŸ”´ Response ok: ' + response.ok);

          const data = await response.json();
          log('ğŸ”´ Response data: ' + JSON.stringify(data));

          if (response.ok) {
            log('âœ… Logout API call successful');
          } else {
            log('âŒ Logout API call failed');
          }
        } catch (error) {
          log('âŒ Error: ' + error.message);
        }
      }

      async function testSessionStatus() {
        log('ğŸ” Checking session status...');
        try {
          const response = await fetch('/api/auth/status', {
            credentials: 'include',
          });

          const data = await response.json();
          log('ğŸ” Session status: ' + JSON.stringify(data));
        } catch (error) {
          log('âŒ Session status error: ' + error.message);
        }
      }

      function clearAllCookies() {
        log('ğŸ§¹ Clearing all cookies...');
        document.cookie =
          'sb-access-token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        document.cookie =
          'sb-refresh-token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        document.cookie =
          'supabase-auth-token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        log('âœ… Cookies cleared');
      }

      // Test on page load
      window.onload = function () {
        log('ğŸ“„ Page loaded, testing session status...');
        testSessionStatus();
      };
    </script>
  </body>
</html>
