<!-- Page Header -->
<div class="page-header">
  <div>
    <h1 class="page-title">Flights</h1>
    <p class="page-description">Manage and track all flight operations and schedules.</p>
  </div>
</div>

<!-- Flights Table -->
<div class="table-container">
  <div class="table-card">
    <div class="table-header">
      <div class="table-title">
        <h3>Flight Operations</h3>
        <span class="table-subtitle">All scheduled and completed flights</span>
      </div>
      <div class="table-actions">
        <button class="btn btn-primary">
          <i class="bi bi-plus-lg"></i>
          Add Flight
        </button>
      </div>
    </div>
    
    <div class="table-wrapper">
      <table class="flights-table">
        <thead>
          <tr>
            <th class="checkbox-col">
              <input type="checkbox" class="form-check-input" id="selectAll">
            </th>
            <th class="sortable">
              DATE
              <i class="bi bi-chevron-down sort-icon"></i>
            </th>
            <th class="sortable">
              FLIGHT NO
              <i class="bi bi-chevron-down sort-icon"></i>
            </th>
            <th class="sortable">
              ROUTE
              <i class="bi bi-chevron-down sort-icon"></i>
            </th>
            <th class="sortable">
              FLIGHT TIME
              <i class="bi bi-chevron-down sort-icon"></i>
            </th>
            <th class="sortable">
              BLOCK TIME
              <i class="bi bi-chevron-down sort-icon"></i>
            </th>
            <th>ACTIONS</th>
          </tr>
        </thead>
        <tbody id="flights-table-body">
          <!-- Data will be loaded via JavaScript -->
        </tbody>
      </table>
    </div>
  </div>
</div>

<script>
// Load flights data from API
async function loadFlights() {
  try {
    const response = await fetch('/api/flights');
    const flights = await response.json();
    
    const tbody = document.getElementById('flights-table-body');
    tbody.innerHTML = '';
    
    flights.forEach(flight => {
      const row = document.createElement('tr');
      
      // Format date
      const date = new Date(flight.flt_date);
      const formattedDate = date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric' 
      });
      
      // Format route: flt_dep - flt_arr
      const route = `${flight.flt_dep} - ${flight.flt_arr}`;
      
      // Format time (convert from HH:MM:SS to HH:MM format)
      const formatTime = (timeString) => {
        const [hours, minutes] = timeString.split(':');
        return `${hours}:${minutes}`;
      };
      
      row.innerHTML = `
        <td class="checkbox-col">
          <input type="checkbox" class="form-check-input">
        </td>
        <td>
          <div class="date-badge">${formattedDate}</div>
        </td>
        <td>
          <div class="flight-number">${flight.flt_number}</div>
        </td>
        <td>
          <div class="route-info">
            <div class="route-main">${route}</div>
            <div class="route-details">Flight Route</div>
          </div>
        </td>
        <td>
          <div class="time-info">
            <div class="time-main">${formatTime(flight.flt_time)}</div>
            <div class="time-details">Flight Time</div>
          </div>
        </td>
        <td>
          <div class="time-info">
            <div class="time-main">${formatTime(flight.flt_block)}</div>
            <div class="time-details">Block Time</div>
          </div>
        </td>
        <td>
          <div class="action-buttons">
            <button class="btn-action" title="View Details" onclick="viewFlight('${flight.id}')">
              <i class="bi bi-eye"></i>
            </button>
            <button class="btn-action" title="Edit" onclick="editFlight('${flight.id}')">
              <i class="bi bi-pencil"></i>
            </button>
            <button class="btn-action" title="Delete" onclick="deleteFlight('${flight.id}')">
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </td>
      `;
      
      tbody.appendChild(row);
    });
  } catch (error) {
    console.error('Error loading flights:', error);
    // Show error message
    const tbody = document.getElementById('flights-table-body');
    tbody.innerHTML = `
      <tr>
        <td colspan="7" style="text-align: center; padding: 2rem; color: #6b7280;">
          <i class="bi bi-exclamation-triangle" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
          Failed to load flights. Please try again.
        </td>
      </tr>
    `;
  }
}

// Action functions
function viewFlight(id) {
  console.log('View flight:', id);
  // TODO: Implement view functionality
}

function editFlight(id) {
  console.log('Edit flight:', id);
  // TODO: Implement edit functionality
}

function deleteFlight(id) {
  console.log('Delete flight:', id);
  // TODO: Implement delete functionality
}

// Load data when page loads
document.addEventListener('DOMContentLoaded', loadFlights);
</script>